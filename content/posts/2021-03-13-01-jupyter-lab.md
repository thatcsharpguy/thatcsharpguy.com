---
layout: post
title: "01: Jupyter Lab"
date: 2021-03-13 14:00:00
summary: "Una breve introducci√≥n a las herramientas para hacer ciencia de datos."
image: http://i3.ytimg.com/vi/RT1VpNAwEWg/maxresdefault.jpg
tags: data fundamentals, data science, machine learning
---

Contacto: [@io_exception](https://twitter.com/io_exception) ¬∑ [That C# guy en YouTube](https://www.youtube.com/channel/UC8KCb358oioQMcJ5pUfs8UQ) ¬∑ [Discord](https://tcsg.dev/discord) ¬∑ [Resto del curso](https://youtube.com/playlist?list=PL6cBnnS2SIgrIUumF2WDTDIiH_lODkLGq) ¬∑ [GitHub](https://github.com/thatcsharpguy/df)

## Entornos virtuales - conda vs. pipenv

Idealmente todo el c√≥digo se ejecuta dentro de un entorno aislado del resto de los programas y aplicaciones instalados en tu computadora, evitando as√≠ que existan conflictos entre dependencias. Esto nos ayuda a dos cosas: nos facilita la vida evitando conflictos entre dependencias y, lo m√°s importante en la ciencia de datos, **ayuda en la reproducibilidad de nuestros experimentos y an√°lisis**.

He hablado sobre entornos virtuales en el pasado: un [video sobre ellos](https://youtu.be/GM-RcOaGN4w) y [un directo tambi√©n](https://youtu.be/ihG0Ya_h188).

En el mundo cient√≠fico-pythonista el gestor de entornos y paquetes por excelencia es [Conda](https://docs.conda.io/en/latest/); sin embargo yo tengo una preferencia personal por [Pipenv](https://pipenv.pypa.io/en/latest/) pues es m√°s ligero, minimalista y completamente enfocado en Python. _Potatos, potatoes_ cualquier gestor de paquetes que decidas usar es bueno.

**Docker**: Puedes ejecutar estos notebooks en un [contenedor de Docker](https://youtu.be/ppl2y4iP2yE) tambi√©n.

## Paquetes

(Entre las primeras cosas que mencionar√© en cada uno de los notebooks estar√° una secci√≥n llamada "Paquetes" en la cual listar√© los paquetes que vamos a usar durante la sesi√≥n, esta informaci√≥n es solo como referencia, los paquetes ya deber√≠an estar instalados si instalaste los requerimientos correctamente desde el inicio)

- `jupyterlab`
- `matplotlib`
- `ipympl`
- `numpy`

(Dependiendo del gestor de paquetes que uses tendr√°s que instalarlos manualmente, por ejemplo `pipenv install jupyterlab` instala `jupyterlab` usando _pipenv_)

## Qu√© es Jupyter Lab

_Jupyter Lab_ es la nueva interfaz gr√°fica que nos permite interactuar con los _Jupyter Notebooks_. Estos _notebooks_ son una versi√≥n mas ... para interactuar con la consola de Python. Cada _notebook_ tiene asociada una consola de Python (tambi√©n conocido como _kernel_) que est√° activa y esperando a que nosotros le mandemos comandos usando la interfaz gr√°fica de nuestros _notebooks_.

Las _Notebooks_ son una implementaci√≥n del paradigma de [programaci√≥n letrada](https://en.wikipedia.org/wiki/Literate_programming) ideado por Donald Knuth. Esto se logra mediante el uso de **celdas (cells)** en donde cada una de estas celdas puede ser de dos tipos: **texto** escrito con [_markdown_](https://en.wikipedia.org/wiki/Markdown) o **c√≥digo** que en este caso vamos a escribir en Python.

### Tecnicalidades

Jupyter funciona con una arquitectura cliente-servidor, lo que ustedes est√°n viendo en esta pantalla es el cliente reperesentado por una aplicaci√≥n web y el servidor es una aplicaci√≥n que se est√° ejecutando en su computadora. Esto significa que podr√≠amos tener el servidor de Jupyter ejecut√°ndose en una computadora m√°s poderosa (por ejemplo, en AWS) y nosotros poder acceder desde cualquier navegador y programar desde ah√≠. A pesar de esto tambi√©n es muy com√∫n tener cliente y servidor en la misma computadora.

**Otros _kernels_**: Es posible configurar nuestro servidor de Jupyter para que acepte otros _kernels_ de disntintos lenguajes o distintas versiones de Python, entre ellos Julia, R y hasta C#.

## Ventajas

- Son perfectos para mostrar tu trabajo
- Facilitan la experimentaci√≥n
- Tienen una curva de aprendizaje relativamente baja
- Su arquitectura las hace ideales para uso remoto

## Desventajas

- Es f√°cil escribir c√≥digo espagueti
- No es tan sencillo colaborar en el mismo _notebook_
- Sin todas las herramientas de un IDE
- Dificultad a la hora de depurar

## Navegando las notebooks

El funcionamiento de las _notebooks_ se centra en una entidad conocida como "celda", a nosotros nos interesan dos tipos de celdas: de c√≥digo y de _markdown_, √©sta y todas las celdas anteriores son celdas de markdown.

- Doble click (o <kbd>Enter</kbd>) en una celda para entrar en modo de edici√≥n
- <kbd>Esc</kbd> para salir de modo de edici√≥n y entrar en modo comandos
- <kbd>Ctrl</kbd> + <kbd>Enter</kbd> ejecuta la celda actual (y permanece en esta)
- <kbd>Shift</kbd> + <kbd>Enter</kbd> ejecuta la celda actual y avanza a la siguiente
- <kbd>Alt</kbd> + <kbd>Enter</kbd> ejecuta la celda actual y crea una nueva justo debajo de la actual
- En modo comandos:
  - <kbd>‚¨Ü</kbd> y <kbd>‚¨á</kbd> para navegar entre celdas
  - <kbd>M</kbd> para cambiar una celda a _markdown_
  - <kbd>Y</kbd> para cambiar una celda a c√≥digo
  - <kbd>D</kbd> + <kbd>D</kbd> para eliminar una celda
  - <kbd>Z</kbd> para deshacer cambios a las celdas
  - <kbd>A</kbd> agrega una celda arriba de la actual
  - <kbd>B</kbd> agrega una celda debajo de la actual

## "!" en las celdas

Puedes poner un `!` como prefijo para indicarle al int√©rprete que el c√≥digo a ejecutar despu√©s del `i` no es un comando para python, sino algo que debe ejecutar en la terminal del sistema operativo del host:

```python
!echo "Hola!"
```

    Hola!

```python
# Podemos combinar comentarios y comandos de consola...
!echo "import jupyterlab; print(jupyterlab.__version__)" > temporary.py
```

```python
# ¬°Podemos combinar Python y comandos de consola!
for i in range(2):
    resultado_consola = !echo "Hello $i"
    print(resultado_consola)
```

    ['Hello 0']
    ['Hello 1']

## "?" en las celdas

Podemos usar el s√≠mbolo "?" para obtener ayuda sobre el c√≥digo en Python, podemos poner el s√≠mbolo antes o despu√©s de la instrucci√≥n sobre la que queremos saber m√°s.

```python
?str
```

    [0;31mInit signature:[0m [0mstr[0m[0;34m([0m[0mself[0m[0;34m,[0m [0;34m/[0m[0;34m,[0m [0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
    [0;31mDocstring:[0m
    str(object='') -> str
    str(bytes_or_buffer[, encoding[, errors]]) -> str

    Create a new string object from the given object. If encoding or
    errors is specified, then the object must expose a data buffer
    that will be decoded using the given encoding and error handler.
    Otherwise, returns the result of object.__str__() (if defined)
    or repr(object).
    encoding defaults to sys.getdefaultencoding().
    errors defaults to 'strict'.
    [0;31mType:[0m           type
    [0;31mSubclasses:[0m     DeferredConfigString, _rstr, LSString, include, ColorDepth, Keys, InputMode, CompleteStyle, SortKey

```python
list?
```

    [0;31mInit signature:[0m [0mlist[0m[0;34m([0m[0miterable[0m[0;34m=[0m[0;34m([0m[0;34m)[0m[0;34m,[0m [0;34m/[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
    [0;31mDocstring:[0m
    Built-in mutable sequence.

    If no argument is given, the constructor creates a new empty list.
    The argument must be an iterable if specified.
    [0;31mType:[0m           type
    [0;31mSubclasses:[0m     _HashedSeq, StackSummary, DeferredConfigList, SList, _ImmutableLineList, FormattedText, NodeList, _ExplodedList, Stack, _Accumulator, ...

## Comandos m√°gicos (?)

En adici√≥n a los signos anteriores, dentro de las celdas de las _notebooks_ tambi√©n podemos usar elementos conocidos como "comandos m√°gicos" que son atajos a funciones √∫tiles.

### Ejecutar un script

```python
# Ejecutando un script de python con %run
%run temporary.py
```

    3.0.9

### Cargar un script

```python
# %load temporary.py
import jupyterlab; print(jupyterlab.__version__)

```

    3.0.9

### Cron√≥metrando nuestro c√≥digo

Siempre es bueno tener una idea de cu√°nto tiempo es que nuestro c√≥digo se va a tardar en ejecutar, podemos usar dos formas de medir el tiempo con los comandos m√°gicos:

- `%%time`: para calcular el tiempo que tarda una celda completa en ejecutarse
- `%timeit`: para calcular el tiempo de ejecuci√≥n de una l√≠nea de c√≥digo (ejecuta la l√≠nea m√∫ltiples veces para analizar el resultado:

```python
%%time
import time
for i in range(4):
    time.sleep(i)
print("done")
```

    done
    CPU times: user 1.46 ms, sys: 1.42 ms, total: 2.87 ms
    Wall time: 6.01 s

```python
import random

# %timeit random.randint(10, 15)
%timeit -n 10 random.randint(10, 15)
```

    The slowest run took 9.03 times longer than the fastest. This could mean that an intermediate result is being cached.
    4.07 ¬µs ¬± 4.51 ¬µs per loop (mean ¬± std. dev. of 7 runs, 10 loops each)

### Gr√°ficando en las _notebooks_

Una de las grandes ventajas que tenemos con las _notebooks_ es que podemos crear gr√°ficas dentro de ellas, mientras que podemos emplear el m√≥dulo `matplotlib`, podemos tambi√©n cambiar el [backend](https://matplotlib.org/stable/tutorials/introductory/usage.html#what-is-a-backend) que estamos usando para graficar; por default el backend es `inline`, pero gracias a [`ipympl`](https://github.com/matplotlib/ipympl) podemos tener gr√°ficas interactivas si cambiamos el backend a `widget` con el comando m√°gico `%matplotlib widget`

```python
import matplotlib.pyplot as plt
import numpy as np
```

```python
%matplotlib inline
# %config InlineBackend.figure_format ='retina'

fig = plt.figure()
plt.plot(np.sin(np.linspace(0, 20, 100)));
```

![png](output_24_0.png)

```python
%matplotlib widget

fig = plt.figure()
plt.plot(np.sin(np.linspace(0, 20, 100)));
```

    Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous ‚Ä¶

> üö® Es importante mencionar que tanto "!", "?" y "%" son elementos disponibles en los _Juypyter Notebooks_, de ninguna manera pertenecen a la sintaxis del lenguaje Python.

## Bonus: $\mu\alpha\tau\epsilon\mu\alpha\tau\iota\kappa\alpha\sigma$

Adem√°s de _markdown_ las celdas de las _notebooks_ permiten usar s√≠mbolos matem√°ticos, mediante el uso del s√≠mbolo `$`, hay dos formas de hacerlo

- _En l√≠nea_: Tenemos que colocar la expresi√≥n matem√°tica entre `$`; ejemplo `$e = m \times c^2$` se ver√° as√≠: $e = m \times c^2$
- _En bloque_: Tenemos que colocar la expresi√≥n matem√°tica entre `$$`; ejemplo `$$e = m \times c^2$$` se ver√° as√≠: $$e = m \times c^2$$

En lecciones subsecuentes vamos a ver algunas f√≥rmulas üßê

## Playground

## Referencias

- https://www.dataquest.io/blog/jupyter-notebook-tips-tricks-shortcuts/
- https://www.edureka.co/blog/cheatsheets/jupyter-notebook-cheat-sheet
